{"version":3,"sources":["index.ts"],"names":["AmplitudeReactNative","NativeModules","Amplitude","constructor","instanceName","_setLibraryName","Constants","packageSourceName","_setLibraryVersion","packageVersion","getInstance","_defaultInstanceName","_instances","Object","prototype","hasOwnProperty","call","init","apiKey","initialize","logEvent","eventType","eventProperties","keys","length","logEventWithProperties","enableCoppaControl","disableCoppaControl","regenerateDeviceId","setDeviceId","deviceId","getDeviceId","setOptOut","optOut","trackingSessionEvents","trackSessionEvents","setUserId","userId","setServerUrl","serverUrl","setUseDynamicConfig","useDynamicConfig","logRevenue","userProperties","logRevenueV2","identify","identifyInstance","payload","setGroup","groupType","groupName","groupIdentify","setUserProperties","clearUserProperties","uploadEvents","setMinTimeBetweenSessionsMillis","minTimeBetweenSessionsMillis","libraryName","setLibraryName","libraryVersion","setLibraryVersion"],"mappings":"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","sourcesContent":["import { NativeModules } from 'react-native';\n\nimport { Constants } from './constants';\nimport { Identify } from './identify';\nimport { AmplitudeReactNativeModule } from './types';\n\nconst AmplitudeReactNative: AmplitudeReactNativeModule =\n  NativeModules.AmplitudeReactNative;\n\nexport { Identify };\n\nexport class Amplitude {\n  private static _instances: Record<string, Amplitude>;\n  private static _defaultInstanceName = '$default_instance';\n  instanceName: string;\n\n  private constructor(instanceName: string) {\n    this.instanceName = instanceName;\n    this._setLibraryName(Constants.packageSourceName);\n    this._setLibraryVersion(Constants.packageVersion);\n  }\n\n  static getInstance(\n    instanceName: string = this._defaultInstanceName,\n  ): Amplitude {\n    if (!this._instances) {\n      this._instances = {};\n    }\n    if (!Object.prototype.hasOwnProperty.call(this._instances, instanceName)) {\n      this._instances[instanceName] = new Amplitude(instanceName);\n    }\n\n    return this._instances[instanceName];\n  }\n\n  init(apiKey: string): Promise<boolean> {\n    return AmplitudeReactNative.initialize(this.instanceName, apiKey);\n  }\n\n  /**\n   * Tracks an event. Events are saved locally.\n   * Uploads are batched to occur every 30 events or every 30 seconds\n   * (whichever comes first), as well as on app close.\n   *\n   * @param eventType The name of the event you wish to track.\n   */\n  logEvent(\n    eventType: string,\n    eventProperties?: Record<string, unknown>,\n  ): Promise<boolean> {\n    if (eventProperties && Object.keys(eventProperties).length > 0) {\n      return AmplitudeReactNative.logEventWithProperties(\n        this.instanceName,\n        eventType,\n        eventProperties,\n      );\n    }\n    return AmplitudeReactNative.logEvent(this.instanceName, eventType);\n  }\n\n  /**\n   * Enable COPPA (Children's Online Privacy Protection Act) restrictions on\n   * IDFA, IDFV, city, IP address and location tracking.\n   *\n   * This can be used by any customer that does not want to collect IDFA, IDFV,\n   * city, IP address and location tracking.\n   */\n  enableCoppaControl(): Promise<boolean> {\n    return AmplitudeReactNative.enableCoppaControl(this.instanceName);\n  }\n\n  /**\n   * Disable COPPA (Children's Online Privacy Protection Act) restrictions on\n   * IDFA, IDFV, city, IP address and location tracking.\n   */\n  disableCoppaControl(): Promise<boolean> {\n    return AmplitudeReactNative.disableCoppaControl(this.instanceName);\n  }\n\n  /**\n   * Regenerate the DeviceId\n   */\n  regenerateDeviceId(): Promise<boolean> {\n    return AmplitudeReactNative.regenerateDeviceId(this.instanceName);\n  }\n\n  /**\n   * Sets a custom device id. <b>Note: only do this if you know what you are doing!</b>\n   *\n   * @param deviceId The device id.\n   */\n  setDeviceId(deviceId: string): Promise<boolean> {\n    return AmplitudeReactNative.setDeviceId(this.instanceName, deviceId);\n  }\n\n  /**\n   * Fetches the deviceId, a unique identifier shared between multiple users using the same app on the same device.\n   * @returns the deviceId.\n   */\n  getDeviceId(): Promise<string> {\n    return AmplitudeReactNative.getDeviceId(this.instanceName);\n  }\n\n  /**\n   * Enables tracking opt out.\n   *\n   * If the user wants to opt out of all tracking, use this method to enable\n   * opt out for them. Once opt out is enabled, no events will be saved locally\n   * or sent to the server.\n   *\n   * Calling this method again with enabled set to false will turn tracking back on for the user.\n   *\n   * @param optOut\n   */\n  setOptOut(optOut: boolean): Promise<boolean> {\n    return AmplitudeReactNative.setOptOut(this.instanceName, optOut);\n  }\n\n  /**\n   * Whether to automatically log start and end session events corresponding to\n   * the start and end of a user's session.\n   *\n   * @param trackSessionEvents\n   */\n  trackingSessionEvents(trackSessionEvents: boolean): Promise<boolean> {\n    return AmplitudeReactNative.trackingSessionEvents(\n      this.instanceName,\n      trackSessionEvents,\n    );\n  }\n\n  /**\n   * If your app has its own login system that you want to track users with,\n   * you can set the userId.\n   *\n   * @param userId\n   */\n  setUserId(userId: string | null): Promise<boolean> {\n    return AmplitudeReactNative.setUserId(this.instanceName, userId);\n  }\n\n  /**\n   * Customize the destination for server url.\n   *\n   * @param serverUrl\n   */\n  setServerUrl(serverUrl: string): Promise<boolean> {\n    return AmplitudeReactNative.setServerUrl(this.instanceName, serverUrl);\n  }\n\n  /**\n   * Dynamically adjust server URL\n   *\n   * @param useDynamicConfig\n   */\n  setUseDynamicConfig(useDynamicConfig: boolean): Promise<boolean> {\n    return AmplitudeReactNative.setUseDynamicConfig(\n      this.instanceName,\n      useDynamicConfig,\n    );\n  }\n\n  /**\n   * Log revenue data.\n   *\n   * Note: price is a required field to log revenue events.\n   * If quantity is not specified then defaults to 1.\n   *\n   * @param userProperties\n   */\n  logRevenue(userProperties: {\n    price: number;\n    productId?: string;\n    quantity?: number;\n    revenueType?: string;\n    receipt?: string;\n    receiptSignature?: string;\n    eventProperties?: { [key: string]: any };\n  }): Promise<boolean> {\n    return AmplitudeReactNative.logRevenueV2(this.instanceName, userProperties);\n  }\n\n  /**\n   * Send an identify call containing user property operations to Amplitude servers.\n   *\n   * @param identifyInstance\n   */\n  identify(identifyInstance: Identify): Promise<boolean> {\n    return AmplitudeReactNative.identify(\n      this.instanceName,\n      identifyInstance.payload,\n    );\n  }\n\n  /**\n   * Adds a user to a group or groups. You need to specify a groupType and groupName(s).\n   * @param groupType\n   * @param groupName\n   */\n  setGroup(groupType: string, groupName: string | string[]): Promise<boolean> {\n    return AmplitudeReactNative.setGroup(\n      this.instanceName,\n      groupType,\n      groupName,\n    );\n  }\n\n  /**\n   * Set or update properties of particular groups\n   *\n   * @param groupType\n   * @param groupName\n   * @param identifyInstance\n   */\n  groupIdentify(\n    groupType: string,\n    groupName: string | string[],\n    identifyInstance: Identify,\n  ): Promise<boolean> {\n    return AmplitudeReactNative.groupIdentify(\n      this.instanceName,\n      groupType,\n      groupName,\n      identifyInstance.payload,\n    );\n  }\n\n  /**\n   * Adds properties that are tracked on the user level.\n   * Note: Property keys must be [String] objects and values must be serializable.\n   *\n   * @param userProperties\n   */\n  setUserProperties(userProperties: Record<string, unknown>): Promise<boolean> {\n    return AmplitudeReactNative.setUserProperties(\n      this.instanceName,\n      userProperties,\n    );\n  }\n\n  /**\n   * Clears all properties that are tracked on the user level.\n   *\n   * Note: This operation is irreversible!!\n   */\n  clearUserProperties(): Promise<boolean> {\n    return AmplitudeReactNative.clearUserProperties(this.instanceName);\n  }\n\n  /**\n   * Upload all unsent events.\n   */\n  uploadEvents(): Promise<boolean> {\n    return AmplitudeReactNative.uploadEvents(this.instanceName);\n  }\n\n  /**\n   * Sets the minimum cutoff time in millisseconds for sessions to be considered distinct.\n   * The default time is 5 minutes.\n   *\n   * @param minTimeBetweenSessionsMillis\n   */\n  setMinTimeBetweenSessionsMillis(\n    minTimeBetweenSessionsMillis: number,\n  ): Promise<boolean> {\n    return AmplitudeReactNative.setMinTimeBetweenSessionsMillis(\n      this.instanceName,\n      minTimeBetweenSessionsMillis,\n    );\n  }\n\n  // Private bridging calls\n  private _setLibraryName(libraryName: string): Promise<boolean> {\n    return AmplitudeReactNative.setLibraryName(this.instanceName, libraryName);\n  }\n\n  private _setLibraryVersion(libraryVersion: string): Promise<boolean> {\n    return AmplitudeReactNative.setLibraryVersion(\n      this.instanceName,\n      libraryVersion,\n    );\n  }\n}\n"]}